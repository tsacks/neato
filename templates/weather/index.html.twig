{% extends 'base.html.twig' %}

{% block title %}Neato!{% endblock %}

{% block body %}
<style>
    table { width: 100%; }
    .city { font-size: 24px; }
    .desc { font-size: 18px; }
    .temp { font-size: 48px; }
    .dow, .image, .cond, .high, .low { width: 85px; }
    .current_temp { text-align: left; }
    .current_cond { text-align: center; }
    .current_misc { text-align: right; }
    table.debug {
        border: 1px solid black;
    }
    table.debug > tr > td {
        border: 1px solid black;
    }
</style>

<div class="wrapper">
    <h2><a href="{{ path('app_news') }}">News</a> &gt; Weather</h2>
    <hr>
</div>

<div class="wrapper">
    <h3>Current Conditions</h3>
    <table>
        <tr>
            <td class="current_temp" width="35%">
                <div class="city">{{ location.name }}</div>
                <div class="temp">{{ forecast.current.temperature_2m|number_format }}{{ forecast.current_units.temperature_2m }}</div>
            </td>
            <td class="current_cond" width="30%">
                <img src="{{ asset( 'images/weather/' ~ wmocodes[forecast.current.weather_code].image ~ '.gif' )}}">
                <div class="desc">{{ wmocodes[forecast.current.weather_code].description }}</div>
            </td>
            <td class="current_misc" width="35%">
                Wind: {{ forecast.current.wind_direction_10m_cardinal }} {{ forecast.current.wind_speed_10m|number_format }} {{ forecast.current_units.wind_speed_10m }}<br>
                Wind Gusts:  {{ forecast.current.wind_gusts_10m|number_format }} {{ forecast.current_units.wind_gusts_10m }}<br>
                Chance of Precipitation: {{ forecast.current.precipitation_probability }}{{ forecast.current_units.precipitation_probability }}<br>
                Relative Humidity: {{ forecast.current.relative_humidity_2m }}{{ forecast.current_units.relative_humidity_2m }}<br>
            </td>
        </tr>
    </table>
    <div><small>Weather data by <a href="https://open-meteo.com/">Open-Meteo.com</a></small></div>
    <hr>
</div>

<div class="wrapper">
    <h3>7 Day Forecast</h3>
    <table>
        <tr><!-- Day of Week -->
            {% for day in forecast.daily.time %}
            <td class="dow">{{ day|date("D")|upper }}</td>
            {% endfor %}
        </tr>
        <tr><!-- Image -->
            {% for code in forecast.daily.weather_code %}
            <td class="image"><img src="{{ asset( 'images/weather/' ~ wmocodes[code].image ~ '.gif') }}"></td>
            {% endfor %}
        </tr>
        <tr><!-- Description -->
            {% for code in forecast.daily.weather_code %}
            <td class="cond">{{ wmocodes[code].description }}</td>
            {% endfor %}
        </tr>
        <tr><!-- High -->
            {% for high in forecast.daily.temperature_2m_max %}
            <td class="high">High {{ high|number_format }}{{forecast.current_units.temperature_2m}}</td>
            {% endfor %}
        </tr>
        <tr><!-- Low -->
            {% for low in forecast.daily.temperature_2m_min %}
            <td class="low">Low {{ low|number_format }}{{forecast.current_units.temperature_2m}}</td>
            {% endfor %}
        </tr>
    </table>
    <hr>
</div>

{% if items is not empty %}
<div class="wrapper">
    <table>

    {% for item in items %}
    <tr>
        <td>
            <img src="{{ item.get_item_tags('http://search.yahoo.com/mrss/', 'thumbnail').1.attribs[''].url }}">
        </td>
        <td>
            <b><a href="{{ item.get_permalink() }}">{{ item.get_title() }}</a></b>
            <div class="datetime">{{ item.get_date() }}</div>
            <p>{{ item.get_description() }}</p>
        </td>
    </tr>
    {% endfor %}
    
    </table>
</div>
{% endif %}

{% endblock %}